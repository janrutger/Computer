# Project Stern: CPU/Computer Simulation

## Overview

Project Stern is a comprehensive digital computer simulation environment designed to explore fundamental computer architecture principles. It features a complete hardware simulation (Stern-XT), a microcoded CPU, and a powerful assembler suite, providing a robust platform for developing and testing assembly language programs.

## Key Components

### Stern-XT Hardware Simulation
The `stern-XT.py` script implements the Stern-XT, a Pygame-based hardware simulation including a CPU, RAM, and various peripheral devices (Display, Keyboard, SIO). It features a 16KB segmented memory map and an interactive command-line debugger.

For detailed information on the hardware and debugger, refer to the [GEMINI.md](GEMINI.md) file.

### CPU Details
The Stern CPU operates on a Fetch-Decode-Execute cycle, driven by microcode. It includes General Purpose Registers (GPRs), Special Registers (PC, SP, MIR), ALU registers (Ra, Rb), and status flags (Z, N, E, S). Its Instruction Set Architecture (ISA) is flexible, supporting up to 90 custom instructions defined by microcode.

More in-depth CPU details, including supported microcode instructions, can be found in [GEMINI.md](GEMINI.md).

### Assembler Suite
The project includes two primary assemblers:

#### 1. ISA Assembler
Located in the `assembler/` directory, this assembler translates high-level assembly language (`.asm` files) into machine-executable binary code (`program.bin`). It dynamically adapts to the CPU's instruction set by reading the `stern_rom.json` file generated by the Microcode Assembler. It supports various directives (e.g., `.`, `%`, `EQU`, `INCLUDE`) and symbol types (`:`, `@`, `~`, `$`).

For a comprehensive guide on using the ISA Assembler, including syntax, directives, and addressing modes, refer to [assembler/ISA_ASSEMBLER_MANUAL.md](assembler/ISA_ASSEMBLER_MANUAL.md).

#### 2. Microcode Assembler
Located in the `microcode_assembler/` directory, this assembler compiles microcode assembly (`.uasm` files) into the `stern_rom.json` file, which defines the CPU's instruction set. It allows for highly customized and extensible instruction set definitions.

For detailed information on designing your own ISA and using the Microcode Assembler, refer to [microcode_assembler/MICROCODE_MANUAL.md](microcode_assembler/MICROCODE_MANUAL.md).

## Getting Started

To run the Stern-XT simulation:
```bash
python3 stern-XT.py
```

To activate the interactive debugger:
```bash
python3 stern-XT.py -debug
```

To assemble an ISA program:
```bash
python3 assembler/assembler.py assembler/asm/my_program.asm
```

To assemble microcode:
```bash
python3 microcode_assembler/assembler.py microcode_assembler/my_microcode.uasm
```

## Project Structure

```
.
├── README.md                   # This overview
├── GEMINI.md                   # Comprehensive project details, hardware, and debugger
├── stern-XT.py                 # Main Stern-XT hardware simulation
├── cpu.py                      # CPU core logic
├── memory.py                   # Memory simulation
├── devices/                    # Peripheral device implementations
│   ├── debugger.py
│   ├── keyboard.py
│   ├── sio.py
│   └── ...
├── assembler/                  # ISA Assembler and related files
│   ├── assembler.py
│   ├── ISA_ASSEMBLER_MANUAL.md # Detailed ISA Assembler manual
│   ├── asm/                    # Example ISA assembly programs
│   └── ...
├── microcode_assembler/        # Microcode Assembler and related files
│   ├── assembler.py
│   ├── MICROCODE_MANUAL.md     # Detailed Microcode Assembler manual
│   ├── base_rom.uasm           # Base microcode definitions
│   └── ...
└── bin/                        # Compiled binary and ROM files
    ├── program.bin
    └── stern_rom.json
```
