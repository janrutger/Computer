VAR argc
VAR target_x
VAR target_y
VAR agent_id

VAR hunter_x
VAR hunter_y
VAR dx
VAR dy
VAR vx
VAR vy

# Define host side functions as syscalls-is's for the FFI interface
CONST HOST.predict  100 ; Syscall ID for the predict function
CONST HOST.train    101 ; Syscall ID for the train function
CONST HOST.plot     102 ; Syscall ID for the plot function

# --- Initialization ---
# For now, let's just set a fixed starting position for the hunter.
50 AS hunter_x
50 AS hunter_y

# --- Main Loop (Verification Mode) ---
:LOOP
    # 1. Calculate deltas (Real calculation)
    target_x hunter_x - AS dx
    target_y hunter_y - AS dy

    # 2. Call PREDICT (Test FFI)
    dx dy 2 2 HOST.predict EXEC
    AS vy
    AS vx

    # 3. Simulate Movement (Ignore NN output for now, just move +1, +1)
    hunter_x 1 + AS hunter_x
    hunter_y 1 + AS hunter_y

    # 4. Call TRAIN (Test FFI with dummy positive reward)
    # Stack: dx dy vx vy reward argc retc syscall_id
    dx dy 1 1 1 5 0 HOST.train EXEC

    # 5. Call PLOT (Test FFI)
    # Stack: agent_id x y argc retc syscall_id
    agent_id hunter_x hunter_y 3 0 HOST.plot EXEC

    # Reset position if too far (Simple animation loop)
    hunter_x 100 > IF 50 AS hunter_x 50 AS hunter_y END

    GOTO LOOP

agent_id PRINT
vx PRINT
vy PRINT